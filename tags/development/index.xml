<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Development on ç•ªèŒ„ğŸ…æ‚è´§é“º</title>
    <link>https://blog.tomatostore.top/tags/development/</link>
    <description>Recent content in Development on ç•ªèŒ„ğŸ…æ‚è´§é“º</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Fri, 19 May 2023 00:00:00 +0000</lastBuildDate><atom:link href="https://blog.tomatostore.top/tags/development/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Use customized class in std::map, std::set</title>
      <link>https://blog.tomatostore.top/posts/2023/05/custom-class-with-std-associative-container/</link>
      <pubDate>Fri, 19 May 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/05/custom-class-with-std-associative-container/</guid>
      <description>Make self-defined class comparable</description>
      <content:encoded><![CDATA[<p>æœ‰ä¸€ä¸ªè‡ªå®šä¹‰çš„ <code>class A</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">getVal</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">val</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">setVal</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="n">val</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“å°è¯•æŠŠ class A çš„å¯¹è±¡å­˜åˆ° std::set æˆ–ä½œä¸ºkeyç”¨åœ¨ std:map ä¸­æ—¶ï¼Œä¼šæœ‰ç¼–è¯‘é”™è¯¯ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;map&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;set&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">A</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">a1</span><span class="p">.</span><span class="n">setVal</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">a2</span><span class="p">.</span><span class="n">setVal</span><span class="p">(</span><span class="o">-</span><span class="mi">200</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">map</span><span class="o">&lt;</span><span class="n">A</span><span class="p">,</span> <span class="n">string</span><span class="o">&gt;</span> <span class="n">mapOfA</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">mapOfA</span><span class="p">[</span><span class="n">a1</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;hello&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">mapOfA</span><span class="p">[</span><span class="n">a2</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#34;world&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">set</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">setOfA</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">setOfA</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">a1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">setOfA</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">a2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>compile error:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">/usr/include/c++/9/bits/stl_function.h: In instantiation of â€˜constexpr bool std::less&lt;_Tp&gt;::operator<span class="o">()(</span>const _Tp<span class="p">&amp;</span>, const _Tp<span class="p">&amp;</span><span class="o">)</span> const <span class="o">[</span>with <span class="nv">_Tp</span> <span class="o">=</span> A<span class="o">]</span>â€™:
</span></span><span class="line"><span class="cl">/usr/include/c++/9/bits/stl_map.h:497:32:   required from â€˜std::map&lt;_Key, _Tp, _Compare, _Alloc&gt;::mapped_type<span class="p">&amp;</span> std::map&lt;_Key, _Tp, _Compare, _Alloc&gt;::operator<span class="o">[](</span>const key_type<span class="p">&amp;</span><span class="o">)</span> <span class="o">[</span>with <span class="nv">_Key</span> <span class="o">=</span> A<span class="p">;</span> <span class="nv">_Tp</span> <span class="o">=</span> std::__cxx11::basic_string&lt;char&gt;<span class="p">;</span> <span class="nv">_Compare</span> <span class="o">=</span> std::less&lt;A&gt;<span class="p">;</span> <span class="nv">_Alloc</span> <span class="o">=</span> std::allocator&lt;std::pair&lt;const A, std::__cxx11::basic_string&lt;char&gt; &gt; &gt;<span class="p">;</span> std::map&lt;_Key, _Tp, _Compare, _Alloc&gt;::mapped_type <span class="o">=</span> std::__cxx11::basic_string&lt;char&gt;<span class="p">;</span> std::map&lt;_Key, _Tp, _Compare, _Alloc&gt;::key_type <span class="o">=</span> A<span class="o">]</span>â€™
</span></span><span class="line"><span class="cl">/home/rduis/Workspace/github/notesnotes/swift/src/custom-class-in-std-map.cpp:25:12:   required from here
</span></span><span class="line"><span class="cl">/usr/include/c++/9/bits/stl_function.h:386:20: error: no match <span class="k">for</span> â€˜operator&lt;â€™ <span class="o">(</span>operand types are â€˜const Aâ€™ and â€˜const Aâ€™<span class="o">)</span>
</span></span><span class="line"><span class="cl">  <span class="m">386</span> <span class="p">|</span>       <span class="o">{</span> <span class="k">return</span> __x &lt; __y<span class="p">;</span> <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>                ~~~~^~~~~
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="solution-1">solution 1:</h2>
<p>declare <code>operator &lt; </code> in class A:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">getVal</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">val</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">setVal</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="n">val</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// solution 1: operator &lt;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">bool</span> <span class="k">operator</span><span class="o">&lt;</span><span class="p">(</span><span class="k">const</span> <span class="n">A</span> <span class="o">&amp;</span><span class="n">rhs</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">.</span><span class="n">getVal</span><span class="p">();</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="solution-2">solution 2:</h2>
<ol>
<li>create a new class as comparator</li>
<li>modify map declaration:</li>
</ol>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="nf">getVal</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">val</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">setVal</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="n">val</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="kt">int</span> <span class="n">val</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// solution 2: delcare comparator
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">comparator</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">bool</span> <span class="k">operator</span><span class="p">()(</span><span class="k">const</span> <span class="n">A</span><span class="o">&amp;</span> <span class="n">lhs</span><span class="p">,</span> <span class="k">const</span> <span class="n">A</span><span class="o">&amp;</span> <span class="n">rhs</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">lhs</span><span class="p">.</span><span class="n">getVal</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">rhs</span><span class="p">.</span><span class="n">getVal</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="why">Why</h2>
<ul>
<li>
<p><code>std::map</code> and <code>std::set</code> are <strong>sorted</strong> associative containers.</p>
</li>
<li>
<p>Sorting is done using the <strong>comparison function Compare</strong>.</p>
</li>
<li>
<p>Declaration of <code>std::map</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">T</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Compare</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">less</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">Allocator</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">pair</span><span class="o">&lt;</span><span class="k">const</span> <span class="n">Key</span><span class="p">,</span> <span class="n">T</span><span class="o">&gt;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">map</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>Declaration of <code>std::map</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">template</span><span class="o">&lt;</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">Key</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">Compare</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">less</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="k">class</span> <span class="nc">Allocator</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">allocator</span><span class="o">&lt;</span><span class="n">Key</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">set</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="ref">Ref</h2>
<ul>
<li><a href="https://en.cppreference.com/w/cpp/container/map">https://en.cppreference.com/w/cpp/container/map</a></li>
<li><a href="https://stackoverflow.com/questions/1102392/how-can-i-use-stdmaps-with-user-defined-types-as-key">https://stackoverflow.com/questions/1102392/how-can-i-use-stdmaps-with-user-defined-types-as-key</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>[C&#43;&#43;11] Scoped Enumeration (enum class)</title>
      <link>https://blog.tomatostore.top/posts/2023/05/cpp-scoped-enum-class/</link>
      <pubDate>Thu, 18 May 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/05/cpp-scoped-enum-class/</guid>
      <description>Strong typed enums in C&#43;&#43;11</description>
      <content:encoded><![CDATA[<h2 id="traditional-enum-in-c">Traditional enum in C++</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">enum</span> <span class="nc">Week</span>        <span class="p">{</span><span class="n">Mon</span>   <span class="p">,</span><span class="n">Tue</span>   <span class="p">,</span><span class="n">Wed</span>  <span class="p">,</span><span class="n">Thu</span>  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">enum</span> <span class="nc">Season</span>      <span class="p">{</span><span class="n">Sprint</span><span class="p">,</span><span class="n">Summer</span><span class="p">,</span><span class="n">Fall</span> <span class="p">,</span><span class="n">Winter</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Week</span> <span class="n">w</span> <span class="o">=</span> <span class="n">Tue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Season</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Summer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">bool</span> <span class="n">isEqual</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="n">s</span><span class="p">);</span> <span class="c1">// isEqual is true
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="problem">Problem</h3>
<p>éç±»å‹å®‰å…¨ï¼Œæ¯”å¦‚å¯¹<code>Week w</code>å’Œ<code>Season s</code>ä¸¤ä¸ªé€»è¾‘æ„ä¹‰ä¸Šä¸åŒç±»å‹çš„å˜é‡ä½œæ¯”è¾ƒï¼Œä¼šäº§ç”Ÿä¸åˆé€»è¾‘çš„ç»“æœï¼š<code>w == s</code> æ˜¯ <code>true</code>ã€‚</p>
<p>It&rsquo;s not safe, the result of <code>w == s</code> is <code>true</code> is not reasonalbe.</p>
<p>ä¸åŒç±»å‹çš„ enum æ¯”è¾ƒä¼šæœ‰ç¼–è¯‘è­¦å‘Š<code>warning</code>ï¼Œä½†åªæ˜¯è­¦å‘Šï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">warning: comparison between â€˜enum Weekâ€™ and â€˜enum Seasonâ€™ <span class="o">[</span>-Wenum-compare<span class="o">]</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>   bool <span class="nv">isEqual</span> <span class="o">=</span> <span class="o">(</span><span class="nv">w</span> <span class="o">==</span> s<span class="o">)</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>                        ^
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="scoped-enum">Scoped enum</h2>
<ul>
<li><code>enum class</code> and <code>enum struct</code> are the same</li>
<li><code>enum class</code> is not a class</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="n">EnumOnly</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">enum</span> <span class="nc">Week</span> <span class="p">{</span> <span class="n">Mon</span><span class="p">,</span> <span class="n">Tue</span><span class="p">,</span> <span class="n">Wed</span><span class="p">,</span> <span class="n">Thu</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">enum</span> <span class="nc">Season</span> <span class="p">{</span> <span class="n">Sprint</span><span class="p">,</span> <span class="n">Summer</span><span class="p">,</span> <span class="n">Fall</span><span class="p">,</span> <span class="n">Winter</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="c1">// namespace EnumOnly
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">namespace</span> <span class="n">EnumClass</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">enum</span> <span class="k">class</span> <span class="nc">Month</span> <span class="p">{</span> <span class="n">Jan</span><span class="p">,</span> <span class="n">Feb</span><span class="p">,</span> <span class="n">Mar</span><span class="p">,</span> <span class="n">Apr</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="k">enum</span> <span class="k">class</span> <span class="nc">Num</span> <span class="p">{</span> <span class="n">One</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Two</span><span class="p">,</span> <span class="n">Three</span><span class="p">,</span> <span class="n">Four</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="c1">// namespace EnumClass
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;EnumOnly::Week::Mon = &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">EnumOnly</span><span class="o">::</span><span class="n">Week</span><span class="o">::</span><span class="n">Mon</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;EnumClass::Month::Jan = &#34;</span> <span class="o">&lt;&lt;</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="p">(</span><span class="n">EnumClass</span><span class="o">::</span><span class="n">Month</span><span class="o">::</span><span class="n">Jan</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Is EnumOnly::Week a class : &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">is_class</span><span class="o">&lt;</span><span class="n">EnumOnly</span><span class="o">::</span><span class="n">Week</span><span class="o">&gt;::</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Is EnumOnly::Week a enum : &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">is_enum</span><span class="o">&lt;</span><span class="n">EnumOnly</span><span class="o">::</span><span class="n">Week</span><span class="o">&gt;::</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Is EnumClass::Month a class : &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">is_class</span><span class="o">&lt;</span><span class="n">EnumClass</span><span class="o">::</span><span class="n">Month</span><span class="o">&gt;::</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;Is EnumClass::Month a enum : &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">is_enum</span><span class="o">&lt;</span><span class="n">EnumClass</span><span class="o">::</span><span class="n">Month</span><span class="o">&gt;::</span><span class="n">value</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">EnumOnly</span><span class="o">::</span><span class="n">Week</span> <span class="n">w</span> <span class="o">=</span> <span class="n">EnumOnly</span><span class="o">::</span><span class="n">Tue</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">EnumOnly</span><span class="o">::</span><span class="n">Season</span> <span class="n">s</span> <span class="o">=</span> <span class="n">EnumOnly</span><span class="o">::</span><span class="n">Summer</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">EnumClass</span><span class="o">::</span><span class="n">Month</span> <span class="n">m</span> <span class="o">=</span> <span class="n">EnumClass</span><span class="o">::</span><span class="n">Month</span><span class="o">::</span><span class="n">Feb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">EnumClass</span><span class="o">::</span><span class="n">Num</span> <span class="n">n</span> <span class="o">=</span> <span class="n">EnumClass</span><span class="o">::</span><span class="n">Num</span><span class="o">::</span><span class="n">Two</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">EnumClass</span><span class="o">::</span><span class="n">Num</span> <span class="n">n2</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="n">EnumClass</span><span class="o">::</span><span class="n">Num</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">EnumClass</span><span class="o">::</span><span class="n">Num</span> <span class="n">n3</span> <span class="o">=</span> <span class="n">EnumClass</span><span class="o">::</span><span class="n">Num</span><span class="o">::</span><span class="n">Three</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">==</span> <span class="n">s</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;w == s, ohh!&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>  <span class="c1">// unmeaningful
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;w != s&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">n2</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;n == n2, yes&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;n != n2, why&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">n3</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;n == n3&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;n != n3, yes&#34;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">  if (w == m) {
</span></span></span><span class="line"><span class="cl"><span class="cm">    cout &lt;&lt; &#34;w == m&#34;;
</span></span></span><span class="line"><span class="cl"><span class="cm">  } else {
</span></span></span><span class="line"><span class="cl"><span class="cm">    cout &lt;&lt; &#34;w != m&#34;;
</span></span></span><span class="line"><span class="cl"><span class="cm">  }
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">EnumOnly::Week::Mon <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">EnumClass::Month::Jan <span class="o">=</span> <span class="m">0</span>
</span></span><span class="line"><span class="cl">Is EnumOnly::Week a class : <span class="m">0</span>
</span></span><span class="line"><span class="cl">Is EnumOnly::Week a enum : <span class="m">1</span>
</span></span><span class="line"><span class="cl">Is EnumClass::Month a class : <span class="m">0</span>
</span></span><span class="line"><span class="cl">Is EnumClass::Month a enum : <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="nv">w</span> <span class="o">==</span> s, ohh!
</span></span><span class="line"><span class="cl"><span class="nv">n</span> <span class="o">==</span> n2, yes
</span></span><span class="line"><span class="cl">n !<span class="o">=</span> n3, yes
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœç”¨ <code>==</code> æ¯”è¾ƒä¸¤ä¸ªä¸åŒç±»å‹çš„ <code>enum class</code> å¯¹è±¡ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ã€‚
æ¯”å¦‚ç”¨<code>if (w == m)</code>æ¯”è¾ƒ <code>enum Week</code> ç±»å‹çš„ <code>w</code> ä¸ <code>enum class Month</code> ç±»å‹çš„ <code>m</code> ä¼šäº§ç”Ÿå¦‚ä¸‹é”™è¯¯ <code>error</code> ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">error: no match <span class="k">for</span> â€˜operator<span class="o">==</span>â€™ <span class="o">(</span>operand types are â€˜EnumOnly::Weekâ€™ and â€˜EnumClass::Monthâ€™<span class="o">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>   <span class="k">if</span> <span class="o">(</span><span class="nv">w</span> <span class="o">==</span> m<span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>       ~ ^~ ~
</span></span><span class="line"><span class="cl">      <span class="p">|</span>       <span class="p">|</span>    <span class="p">|</span>
</span></span><span class="line"><span class="cl">      <span class="p">|</span>       <span class="p">|</span>    EnumClass::Month
</span></span><span class="line"><span class="cl">      <span class="p">|</span>       EnumOnly::Week
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç”¨ <code>==</code> æ¯”è¾ƒä¸¤ä¸ªä¸åŒçš„ <code>enum class</code> å¯¹è±¡ä¹Ÿä¼šäº§ç”Ÿç›¸åŒçš„ç¼–è¯‘é”™è¯¯ã€‚</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>error: git object file .git/objects/xxx is empty å’Œ fatal: cannot read existing object info</title>
      <link>https://blog.tomatostore.top/posts/2023/04/git-object-file-is-empty/</link>
      <pubDate>Thu, 20 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/git-object-file-is-empty/</guid>
      <description>index-pack failedï¼Œunable to unlink null bad address</description>
      <content:encoded><![CDATA[<h2 id="object-file-ç›¸å…³é”™è¯¯"><code>object file</code> ç›¸å…³é”™è¯¯</h2>
<p>æœ¬åœ°çš„<code>repo</code>åœ¨æ‰§è¡Œ<code>git log</code>å’Œ<code>git pull</code>å‘½ä»¤æ—¶å‡ºç°äº†å¦‚ä¸‹å…³äº<code>object file</code>çš„é”™è¯¯ï¼š</p>
<h3 id="git-log-é”™è¯¯"><code>git log</code> é”™è¯¯</h3>
<pre tabindex="0"><code>&gt;&gt;&gt;&gt; $ git log
error: object file .git/objects/7b/40exxx is empty
error: object file .git/objects/7b/40exxx is empty
fatal: loose object 7b40exxx (stored in .git/objects/7b/40exxx) is corrupt
</code></pre><h3 id="git-pull-é”™è¯¯"><code>git pull</code> é”™è¯¯</h3>
<pre tabindex="0"><code>&gt;&gt;&gt;&gt; $ git pull
error: object file .git/objects/7b/40exxx is empty
error: object file .git/objects/7b/40exxx is empty
remote: Counting objects: 479, done
remote: Finding sources: 100% (1388/1388)
error: object file .git/objects/7b/40exxx is empty
fatal: cannot read existing object info 40exxx
fatal: index-pack failed
warning: unable to unlink &#39;(null)&#39;: Bad address
</code></pre><h2 id="è§£å†³æ–¹æ³•-solution">è§£å†³æ–¹æ³• Solution</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> &lt;your_repo&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># å¤‡ä»½ .git</span>
</span></span><span class="line"><span class="cl">cp -r .git .git-bak
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> .git
</span></span><span class="line"><span class="cl">find . -type f -empty -delete -print
</span></span><span class="line"><span class="cl">git fsck --full
</span></span></code></pre></td></tr></table>
</div>
</div><p>å†æ¬¡å°è¯•<code>git log</code> å’Œ <code>git pull</code>å‘½ä»¤ã€‚ä¸€åˆ‡æ­£å¸¸ååˆ é™¤å¤‡ä»½ <code>rm -r .git-bak</code>ã€‚</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>å¦‚ä½•ä» App Store Connect ä¸­åˆ é™¤ä¸€ä¸ªæœªå‘å¸ƒç‰ˆæœ¬</title>
      <link>https://blog.tomatostore.top/posts/2023/04/app-store-connect-rm-a-version/</link>
      <pubDate>Thu, 20 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/app-store-connect-rm-a-version/</guid>
      <description>è‹¹æœå•†åº—Connectæ— æ³•åˆ é™¤Appç‰ˆæœ¬</description>
      <content:encoded><![CDATA[<p>ä¸€ä¸ª iOS App æœ€æ–°å·²å‘å¸ƒç‰ˆæœ¬: <code>4.0</code>ï¼Œåœ¨ <code>App Store Connect</code> ä¸­æ·»åŠ äº†ä¸€ä¸ªç‰ˆæœ¬ <code>4.1</code>ï¼ŒçŠ¶æ€ä¸º <code>å‡†å¤‡æäº¤ï¼ˆPrepare for Submissionï¼‰</code> (æˆ–å…¶ä»–æœªå‘å¸ƒçŠ¶æ€)ã€‚</p>
<p>åæ¥æ”¹åŠ¨æœ‰ç‚¹å¤§ï¼Œæ‰“ç®—åšä¸ªå¤§ç‰ˆæœ¬å‡çº§â€”â€”æŠŠ<code>4.1</code> æ”¹ä¸º <code>5.0</code>ã€‚</p>
<p>æ²¡æœ‰æ‰¾åˆ°åˆ é™¤ <code>4.1</code> çš„æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¦‚ä¸‹é€”å¾„æ›´æ”¹ç‰ˆæœ¬ä¸º <code>5.0</code>:</p>
<p>åœ¨ <code>version 4.1</code> æ„å»ºé¡µé¢çš„ ç‰ˆæœ¬ä¿¡æ¯ï¼ˆVersion Informationï¼‰ æ¨¡å—ä¸‹å°†ç‰ˆæœ¬ <code>4.1</code> ç›´æ¥æ”¹ä¸º <code>5.0</code>:</p>
<p><img loading="lazy" src="/images/v4.1.png" alt="v5.0"  /></p>
<p>ç‚¹å‡» ä¿å­˜ï¼ˆSaveï¼‰æŒ‰é’®ï¼Œç‰ˆæœ¬ <code>4.1</code> å°±å˜æˆ <code>5.0</code> å•¦ï¼š</p>
<p><img loading="lazy" src="/images/v5.0.png" alt="v5.0"  /></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>å¦‚ä½•åœ¨ Markdown ä¸­æ’å…¥å›¾ç‰‡ï¼Œå¹¶è®¾ç½®å¤§å°</title>
      <link>https://blog.tomatostore.top/posts/2023/04/markdown-insert-picture-with-size/</link>
      <pubDate>Thu, 20 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/markdown-insert-picture-with-size/</guid>
      <description>Add pictures to Markdown, with hyperlink and size setting</description>
      <content:encoded><![CDATA[<p>æœ¬æ–‡ä»‹ç»åœ¨ <code>Markdown</code> æ–‡ä»¶ä¸­æ’å…¥å›¾ç‰‡çš„ä¸¤ç§æ–¹å¼ï¼š<a href="#markdown_insert_img">1.Markdownè¯­æ³•</a>ï¼Œ<a href="#html_insert_img">2.HTMLè¯­æ³•</a>ï¼›
ä»¥åŠ<a href="#image_size">å¦‚ä½•è®¾ç½®å›¾ç‰‡å°ºå¯¸</a>ï¼Œ<a href="#image_link">å¦‚ä½•ç»™å›¾ç‰‡åŠ é“¾æ¥</a>ã€‚</p>
<p><a name="markdown_insert_img"></a></p>
<h2 id="1-ä½¿ç”¨-markdown-è¯­æ³•">1. ä½¿ç”¨ <code>Markdown</code> è¯­æ³•</h2>
<ul>
<li>ä»¥å¹å·<code>!</code>å¼€å¤´</li>
<li>åé¢æ–¹æ‹¬å·<code>[]</code>ä¸­æ˜¯æ›¿æ¢æ–‡æœ¬ï¼ˆå›¾ç‰‡åŠ è½½å¤±è´¥æ—¶æ˜¾ç¤ºç»™è¯»è€…çš„æ–‡æœ¬ï¼‰</li>
<li>å†åé¢åœ†æ‹¬å·<code>()</code>ä¸­æ˜¯å›¾ç‰‡çš„è·¯å¾„ï¼ˆæœ¬åœ°è·¯å¾„ã€ç½‘ç»œè·¯å¾„ï¼‰</li>
<li>å¦‚æœéœ€è¦å›¾ç‰‡æ ‡é¢˜ï¼Œå¯ä»¥åœ¨è·¯å¾„åé¢ç”¨åŒå¼•å·<code>&quot;&quot;</code>æ‰©èµ·æ¥ã€‚
<em>âš ï¸ï¼šæ‰€æœ‰çš„<strong>ç¬¦å·å¿…é¡»æ˜¯åŠè§’/è‹±æ–‡ç¬¦å·</strong>ï¼Œä¸å¯ä»¥ä½¿ç”¨å…¨è§’/ä¸­æ–‡ç¬¦å·</em></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">![<span class="nt">æ›¿æ¢æ–‡æœ¬</span>](<span class="na">å›¾ç‰‡è·¯å¾„ &#34;å›¾ç‰‡æ ‡é¢˜&#34;</span>)
</span></span><span class="line"><span class="cl">![<span class="nt">alt text</span>](<span class="na">image_path &#34;image title&#34;</span>)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¯”å¦‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">![<span class="nt">substring is deprecated</span>](<span class="na">/images/xcode-while-editing.png &#34;XCodeå±å¹•æˆªå›¾&#34;</span>)
</span></span><span class="line"><span class="cl"><span class="ge">*Tips: å¯ä»¥åœ¨å›¾ç‰‡ä¸‹é¢ç”¨ä¸€è¡Œæ–œä½“çš„è¯´æ˜æ–‡æœ¬ã€‚å›¾ç‰‡æ ‡é¢˜ä¸ä¿è¯ä¸€å®šä¼šæ˜¾ç¤º*</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š
<img loading="lazy" src="/images/xcode-while-editing.png" alt="substring is deprecated"  title="XCodeå±å¹•æˆªå›¾"  />
<em>Tips: å¯ä»¥åœ¨å›¾ç‰‡ä¸‹é¢ç”¨ä¸€è¡Œæ–œä½“çš„è¯´æ˜æ–‡æœ¬ã€‚å›¾ç‰‡æ ‡é¢˜ä¸ä¿è¯ä¸€å®šä¼šæ˜¾ç¤º</em></p>
<p><a name="html_insert_img"></a></p>
<h2 id="2-ä½¿ç”¨-html-è¯­æ³•">2. ä½¿ç”¨ <code>HTML</code> è¯­æ³•</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">image</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://picsum.photos/400/200&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;ç½‘ç»œå›¾ç‰‡400*200&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ•ˆæœå¦‚ä¸‹ï¼š
<image src="https://picsum.photos/400/200" alt="ç½‘ç»œå›¾ç‰‡400*200" title="HTMLå›¾ç‰‡"></p>
<p><a name="image_size"></a></p>
<h3 id="å¦‚ä½•è®¾ç½®å›¾ç‰‡å°ºå¯¸">å¦‚ä½•è®¾ç½®å›¾ç‰‡å°ºå¯¸</h3>
<p>æ¨èä½¿ç”¨<code>HTML</code>çš„æ–¹å¼è®¾ç½®å›¾ç‰‡å¤§å°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">image</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://picsum.photos/400/200&#34;</span> <span class="na">alt</span><span class="o">=</span><span class="s">&#34;ç½‘ç»œå›¾ç‰‡400*200&#34;</span> <span class="na">width</span><span class="o">=</span><span class="s">&#34;100&#34;</span> <span class="na">height</span><span class="o">=</span><span class="s">&#34;200&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><image src="https://picsum.photos/400/200" alt="ç½‘ç»œå›¾ç‰‡400*200" width="100" height="200">
<p>åŸç”Ÿ<code>Markdown</code>è¯­æ³•ä¸æ”¯æŒè®¾ç½®å›¾ç‰‡å°ºå¯¸ï¼Œ<code>Extended Markdown</code>æ”¯æŒå¦‚ä¸‹è¯­æ³•ã€‚ä¸æ˜¯æ‰€æœ‰å¼•æ“éƒ½æ”¯æŒï¼Œä¸ªäººä¸æ¨èã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">![<span class="nt">alt text</span>](<span class="na">image path &#34;image title&#34;</span>){ width=80%,height=120px }
</span></span></code></pre></td></tr></table>
</div>
</div><a name="image_link" />
<h3 id="å¦‚ä½•ç»™å›¾ç‰‡åŠ é“¾æ¥">å¦‚ä½•ç»™å›¾ç‰‡åŠ é“¾æ¥</h3>
<h4 id="markdownè¯­æ³•"><code>Markdown</code>è¯­æ³•</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">[<span class="nt">![å›¾ç‰‡æ›¿æ¢æ–‡æœ¬</span>](<span class="na">å›¾ç‰‡è·¯å¾„</span>)](é“¾æ¥åœ°å€)
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¯”å¦‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl">[<span class="nt">![ç‚¹å‡»å›¾ç‰‡è·³è½¬AppStore</span>](<span class="na">https://mzstatic.com/image/AppIcon.png</span>)](https://apps.apple.com)
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://apps.apple.com/cn/app/id1528477391">
  <img loading="lazy" src="https://is4-ssl.mzstatic.com/image/thumb/Purple122/v4/72/62/8a/72628ae2-9c11-e676-acb2-5e207f07aa65/AppIcon-1x_U007emarketing-0-6-0-85-220.png/460x0w.webp" alt="ç‚¹å‡»å›¾ç‰‡è·³è½¬AppStore"  /></a></p>
<h4 id="htmlè¯­æ³•"><code>HTML</code>è¯­æ³•</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://apps.apple.com/cn/app/id1528477391&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://mzstatic.com/image/AppIcon.png&#34;</span><span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><a href="https://apps.apple.com/cn/app/id1528477391">
    <img src="https://is4-ssl.mzstatic.com/image/thumb/Purple122/v4/72/62/8a/72628ae2-9c11-e676-acb2-5e207f07aa65/AppIcon-1x_U007emarketing-0-6-0-85-220.png/460x0w.webp" />
</a>
]]></content:encoded>
    </item>
    
    <item>
      <title>Bad owner or permissions on ssh config/gitå‘½ä»¤.sshæ–‡ä»¶æƒé™é”™è¯¯</title>
      <link>https://blog.tomatostore.top/posts/2023/04/ssh-file-permission/</link>
      <pubDate>Mon, 17 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/ssh-file-permission/</guid>
      <description>ssh Permissions are too open</description>
      <content:encoded><![CDATA[<p>åœ¨ macOS çš„ç»ˆç«¯ä¸­æ‰§è¡Œ <code>git pull</code> å‘½ä»¤æ—¶å‡ºç°å¦‚ä¸‹ä¸¤ä¸ªé”™è¯¯ï¼Œå¯ä»¥é€šè¿‡æ‰‹åŠ¨ä¿®æ”¹æƒé™æ¥ä¿®å¤ã€‚åŒæ ·é€‚ç”¨äº Linux ç³»ç»ŸåŠå…¶ä»– ssh ç›¸å…³åº”ç”¨å‡ºç°çš„æ­¤ç±»é”™è¯¯ã€‚</p>
<ul>
<li>é”™è¯¯ä¸€ï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">Bad owner or permissions on &lt;user&gt;/.ssh/config
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>é”™è¯¯äºŒï¼š</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
</span></span><span class="line"><span class="cl">@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
</span></span><span class="line"><span class="cl">@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
</span></span><span class="line"><span class="cl">Permissions 0640 for &#39;&lt;user&gt;/.ssh/id_rsa&#39; are too open.
</span></span><span class="line"><span class="cl">It is required that your private key files are NOT accessible by others.
</span></span><span class="line"><span class="cl">This private key will be ignored.
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="solution">Solution</h2>
<p>é€šè¿‡å¦‚ä¸‹æ–¹å¼æ‰‹åŠ¨ä¿®å¤ <code>.ssh</code> ç›®å½•åŠæ–‡ä»¶æƒé™ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="nb">cd</span> ~/.ssh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">sudo chmod <span class="m">700</span> .      <span class="c1"># .ssh dir</span>
</span></span><span class="line"><span class="cl">sudo chmod <span class="m">700</span> *.pub  <span class="c1"># PUBLIC key file</span>
</span></span><span class="line"><span class="cl">sudo chmod <span class="m">600</span> id_rsa <span class="c1"># PRIVATE key file</span>
</span></span><span class="line"><span class="cl">sudo chmod <span class="m">600</span> config <span class="c1"># config file</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="reference">Reference</h2>
<p>å…¶ä»–ç±»å‹æ–‡ä»¶çš„æƒé™åŠè¯¦ç»†æè¿°å‚è§ <code>man ssh</code>ï¼š</p>
<p><img loading="lazy" src="/images/man-ssh.png" alt="man ssh"  /></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Swift String Substring</title>
      <link>https://blog.tomatostore.top/posts/2023/04/swift-substring/</link>
      <pubDate>Sun, 16 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/swift-substring/</guid>
      <description>Swift ä¸­å¯¹ String ç±»å‹çš„ substring() æ–¹æ³•éƒ½è¢«æ ‡è®°ä¸ºä¸æ¨è(deprecated)äº†ï¼Œé‚£è¯¥å¦‚ä½•å®ç° substring çš„åŠŸèƒ½å‘¢ï¼Ÿ æ ¹æ®Xcodeçš„æç¤ºå¯ä»¥ä½¿ç”¨slicingï¼ˆåˆ‡ç‰‡ï¼‰çš„</description>
      <content:encoded><![CDATA[<p>Swift ä¸­å¯¹ <code>String</code> ç±»å‹çš„ <code>substring()</code> æ–¹æ³•éƒ½è¢«æ ‡è®°ä¸º<code>ä¸æ¨è(deprecated)</code>äº†ï¼Œé‚£è¯¥å¦‚ä½•å®ç° substring çš„åŠŸèƒ½å‘¢ï¼Ÿ</p>
<p><img loading="lazy" src="/images/swift-string-substring-deprecated.jpg" alt="substring is deprecated"  title="XCode ä¸­å¯¹String.substringçš„æç¤º"  /></p>
<p>æ ¹æ®Xcodeçš„æç¤º<strong>å¯ä»¥ä½¿ç”¨<code>slicingï¼ˆåˆ‡ç‰‡ï¼‰</code>çš„æ–¹å¼æ¥å®ç°<code>substring</code>çš„åŠŸèƒ½</strong>ï¼š</p>
<p>ä»¥å­—ç¬¦ä¸² <code>let str = &quot;0123456789&quot;</code> ä¸ºä¾‹:</p>
<h3 id="ä»å¼€å§‹åˆ°ç¬¬ä¸€ä¸ªç­‰äº5çš„å­—ç¬¦ä¹‹å‰çš„å­ä¸²">ä»å¼€å§‹åˆ°ç¬¬ä¸€ä¸ªç­‰äº<code>5</code>çš„å­—ç¬¦ä¹‹å‰çš„å­ä¸²ï¼š</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="k">if</span> <span class="kd">let</span> <span class="nv">firstFive</span> <span class="p">=</span> <span class="n">str</span><span class="p">.</span><span class="n">firstIndex</span><span class="p">(</span><span class="n">of</span><span class="p">:</span> <span class="s">&#34;5&#34;</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nv">substr</span> <span class="p">=</span> <span class="n">str</span><span class="p">[</span><span class="n">str</span><span class="p">.</span><span class="n">startIndex</span><span class="p">..&lt;</span><span class="n">firstFive</span><span class="p">]</span> <span class="c1">// substr = 01234</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æˆ–è€…å¯ä»¥çœç•¥å¼€å§‹çš„index</span>
</span></span><span class="line"><span class="cl">    <span class="kd">let</span> <span class="nv">substr2</span> <span class="p">=</span> <span class="n">str</span><span class="p">[..&lt;</span><span class="n">firstFive</span><span class="p">]</span> <span class="c1">// substr2 = 01234</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä»å¼€å¤´åˆ°ç¬¬ä¸€ä¸ªç­‰äº5çš„å­—ç¬¦">ä»å¼€å¤´åˆ°ç¬¬ä¸€ä¸ªç­‰äº<code>5</code>çš„å­—ç¬¦</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nv">substr</span> <span class="p">=</span> <span class="n">str</span><span class="p">[...</span><span class="n">firstFive</span><span class="p">]</span> <span class="c1">// substr = 012345</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ä»ç¬¬ä¸€ä¸ª5å¼€å§‹åˆ°å­—ç¬¦ä¸²æœ«å°¾">ä»ç¬¬ä¸€ä¸ª<code>5</code>å¼€å§‹åˆ°å­—ç¬¦ä¸²æœ«å°¾</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nv">substr</span> <span class="p">=</span> <span class="n">str</span><span class="p">[</span><span class="n">firstFive</span><span class="p">...]</span> <span class="c1">// 56789</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="å‰7ä¸ªå­—ç¬¦">å‰7ä¸ªå­—ç¬¦</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="kd">let</span> <span class="nv">strstr</span> <span class="p">=</span> <span class="n">str</span><span class="p">[</span><span class="n">str</span><span class="p">.</span><span class="n">startIndex</span><span class="p">..&lt;</span><span class="n">str</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">str</span><span class="p">.</span><span class="n">startIndex</span><span class="p">,</span> <span class="n">offsetBy</span><span class="p">:</span> <span class="mi">7</span><span class="p">)]</span> <span class="c1">// 0123456</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>String</code>åˆ‡ç‰‡åè¿”å›çš„ç»“æœç±»å‹æ˜¯ <code>Substring</code>ã€‚</p>
<h2 id="struct-substring">struct Substring</h2>
<p><code>Substring</code> ä¸ä¼šä¸ºå­—ç¬¦ä¸²é¢å¤–åˆ†é…ç©ºé—´ï¼Œè€Œæ˜¯ä¸åŸå§‹å­—ç¬¦ä¸²å…±äº«å­˜å‚¨ã€‚</p>
<blockquote>
<p><strong>åˆ’é‡ç‚¹ï¼š</strong> å› ä¸º<code>Substring</code>ä¼šæŒæœ‰å¯¹åŸå§‹å­—ç¬¦å­˜å‚¨çš„å¼•ç”¨è®¡æ•°ï¼Œæ‰€ä»¥è¦ç¡®ä¿å­ä¸²çš„ç”Ÿå‘½å‘¨æœŸä¸é•¿äºæºå­—ç¬¦ä¸²çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»¥å…å†…å­˜æ³„æ¼ã€‚</p>
</blockquote>
<hr>
<blockquote>
<p>Ref: <a href="https://swiftunboxed.com/stdlib/substrings">https://swiftunboxed.com/stdlib/substrings</a></p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>å…³äºASCIIã€DBCSã€Unicodeã€UCS-16ã€UTF-8å’ŒEncoding</title>
      <link>https://blog.tomatostore.top/posts/2023/04/unicode-and-character-sets/</link>
      <pubDate>Wed, 12 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/unicode-and-character-sets/</guid>
      <description>æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„å­—ç¬¦é›†å‘å±•ç®€å²</description>
      <content:encoded><![CDATA[<p>å†™äºäºŒåå¹´å‰(<code>2003å¹´</code>)çš„æ–‡ç« ï¼Œç°åœ¨ä¾ç„¶å—ç”¨ã€‚</p>
<p>ä½ æ˜¯å¦æ›¾æ¢ç©¶è¿‡<code>HTTP</code>è¯·æ±‚ä¸­ç¥ç§˜çš„<code>Content-Type</code>ï¼Ÿä½ æ˜¯å¦æ›¾é‡åˆ°è¿‡æ»¡æ˜¯é—®å· <code>???? ???? ??</code> çš„ç”µå­é‚®ä»¶ï¼ˆæˆ–ç½‘é¡µï¼‰ï¼Ÿ</p>
<p>ä½œè€…å‘ç°å¤šæ•°ç¨‹åºå¼€å‘äººå‘˜å¹¶ä¸æ˜¯å®Œå…¨æ˜ç™½å­—ç¬¦é›†<code>character set</code>ã€ç¼–ç <code>encoding</code>ã€<code>Unicode</code>ã€<code>UTF-8</code>ç­‰ç›¸å…³è¯é¢˜ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« å›é¡¾äº†å­—ç¬¦é›†çš„å‘å±•å†å²ã€‚</p>
<p><img loading="lazy" src="/images/ascii.png" alt="ASCII"  /></p>
<h2 id="asciiamerican-standard-code-for-information-interchangeç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç "><code>ASCII</code>ï¼ˆ<code>American Standard Code for Information Interchange</code>ï¼Œç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼‰</h2>
<p>å›åˆ°<code>Unix</code>æ­£åœ¨è¢«å‘æ˜çš„ä¸Šå¤æ—¶ä»£ï¼Œä¸€ä¸ªè‹±æ–‡å­—ç¬¦çš„<code>ASCII</code>å€¼å¯ä»¥ç”¨ <code>32-127</code> èŒƒå›´å†…çš„æ•°å­—æ¥è¡¨ç¤ºï¼ŒåŒ…æ‹¬è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œç¬¦å·ã€‚
æ¯”å¦‚ç©ºæ ¼æ˜¯<code>32</code>ï¼Œ<code>A</code>æ˜¯<code>65</code>ï¼Œ<code>a</code>æ˜¯<code>97</code>ã€‚ <code>0-31</code> è¢«ç”¨ä½œæ“ä½œç¬¦ã€‚å¦‚<code>10</code>ä¸ºæ¢è¡Œï¼Œ<code>13</code>ä¸ºå›è½¦ã€‚</p>
<p>è®¡ç®—æœºçš„æœ€å°å¯»å€å•ä½æ˜¯ä¸€å­—èŠ‚ï¼ˆ<code>8</code>ä¸ªæ¯”ç‰¹ï¼‰ï¼Œ<code>127</code>åªéœ€è¦<code>7</code>ä¸ªæ¯”ç‰¹ä½å°±èƒ½è¡¨ç¤ºï¼ˆ<code>2çš„7æ¬¡æ–¹=128</code>ï¼‰ï¼Œæ‰€ä»¥è¿˜æœ‰ä¸€æ¯”ç‰¹ä½ï¼ˆå€¼<code>128-255</code>ï¼‰ç©ºé—²ã€‚</p>
<p>è¿™äº›ç©ºé—²çš„å€¼åœ¨ä¸åŒçš„è¯­è¨€åœ°åŒºè¢«èµ‹äºˆä¸åŒçš„ç”¨æ³•ã€‚æ¯”å¦‚ç¾æ´²åœ°åŒºç”¨<code>130</code>æ¥è¡¨ç¤º<code>Ã©</code>ï¼Œä½†æ˜¯ä»¥è‰²åˆ—çš„ç”µè„‘ç”¨<code>130</code>æ¥è¡¨ç¤ºå¸Œä¼¯æ¥å­—ç¬¦<code>×’</code>ã€‚é‚£ä¹ˆåœ¨ç¾æ´²ç”µè„‘ä¸Šæ˜¾ç¤ºçš„å•è¯<code>rÃ©sumÃ©s</code>ï¼Œåœ¨ä»¥è‰²åˆ—çš„ç”µè„‘ä¸Šå°±æˆäº† <code>r×’sum×’s</code>ã€‚è¿™å¯¼è‡´äº†åŒä¸€æ–‡æ¡£å†…å®¹åœ¨ä¸åŒçš„ç”µè„‘ä¸Šå¯èƒ½æœ‰ä¸åŒçš„æ˜¾ç¤ºã€‚</p>
<h2 id="code-pageä»£ç é¡µ">Code Pageï¼ˆä»£ç é¡µï¼‰</h2>
<p><code>ANSI</code>ï¼ˆ<code>American National Standards Institute</code>ï¼Œç¾å›½å›½å®¶æ ‡å‡†å­¦ä¼šï¼‰åœ¨åˆ¶å®šæ ‡å‡†çš„æ—¶å€™ï¼Œå¼•å…¥äº†ä»£ç é¡µã€‚</p>
<p>è¿™äº›ä»£ç é¡µ<code>128</code>ä»¥ä¸‹æ˜¯ä¸€æ ·çš„ï¼Œåªæœ‰<code>128</code>ä»¥ä¸Šä¸åŒã€‚å¦‚ï¼Œä»¥è‰²åˆ—ä½¿ç”¨<code>code page 862</code>ï¼Œå¸Œè…Šä½¿ç”¨ <code>code page 737</code>ã€‚</p>
<p>è¿™æ ·åœ¨åŒä¸€ç”µè„‘ä¸Šå¯ä»¥æœ‰å¤šä¸ªä¸åŒçš„ä»£ç é¡µå¯ä¾›é€‰æ‹©ã€‚</p>
<h2 id="dbcsdouble-byte-character-setåŒå­—èŠ‚å­—ç¬¦é›†"><code>DBCS</code>ï¼ˆ<code>Double Byte Character Set</code>ï¼ŒåŒå­—èŠ‚å­—ç¬¦é›†ï¼‰</h2>
<p>ä½†æ˜¯ï¼Œç”±äºäºšæ´²è¯­è¨€æœ‰æˆåƒä¸Šä¸‡çš„å­—ç¬¦ï¼Œæ²¡åŠæ³•ç”¨ä¸€å­—èŠ‚ï¼ˆ<code>8</code>æ¯”ç‰¹ï¼‰å®Œå…¨è¡¨ç¤ºã€‚</p>
<p><code>DBCS</code> æ˜¯å¯¹è‹±æ–‡å­—ç¬¦ä½¿ç”¨å•å­—èŠ‚ï¼Œå…¶ä»–å­—ç¬¦ï¼ˆå¦‚ä¸­æ—¥éŸ©æ–‡ï¼‰ä½¿ç”¨åŒå­—èŠ‚ã€‚è®¿é—®æ–‡æœ¬æ—¶ï¼Œåªèƒ½ä»å‰å‘åå¤„ç†ã€‚å› ä¸ºéœ€è¦ä¸€ç›´åˆ¤æ–­å½“å‰å­—èŠ‚æ˜¯ä¸æ˜¯å‰å¯¼å­—èŠ‚ï¼Œå¯¹äºæ—¢æœ‰å¯èƒ½æ˜¯å‰å¯¼ä¹Ÿæœ‰å¯èƒ½æ˜¯åç»­çš„å­—èŠ‚ï¼Œåªèƒ½é€šè¿‡ä¸Šä¸‹æ–‡åšåˆ¤æ–­ã€‚</p>
<p>å¯¹è®¡ç®—æœºç¨‹åºåŠç¨‹åºå‘˜æ¥è¯´ï¼Œæ“ä½œèµ·æ¥æ¯”è¾ƒéº»çƒ¦ã€å®¹æ˜“å‡ºé”™ã€‚</p>
<h2 id="unicodeç»Ÿä¸€ç ä¸‡å›½ç "><code>Unicode</code>ï¼ˆç»Ÿä¸€ç ã€ä¸‡å›½ç ï¼‰</h2>
<p>ä¸€å¥—å¯ä»¥é€‚ç”¨äºå…¨ä¸–ç•Œæ‰€æœ‰å›½å®¶çš„å­—ç¬¦é›†ã€‚</p>
<p>å¯¹ <code>Unicode</code> æœ€å¸¸è§çš„è¯¯è§£æ˜¯ï¼šæ¯ä¸ªå­—ç¬¦å ç”¨<code>16</code>æ¯”ç‰¹ï¼Œå› æ­¤èƒ½è¡¨ç¤ºçš„å­—ç¬¦ä¸ªæ•°æ˜¯ <code>2çš„16æ¬¡æ–¹=65536</code>ä¸ªã€‚å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸å¯¹çš„ã€‚</p>
<p><code>Unicode</code> ä¸­å¯¹æ‰€æœ‰å­—æ¯è¡¨ä¸­çš„æ¯ä¸ªå­—ç¬¦åˆ†é…ä¸€ä¸ªæ•°å­—â€”â€”<code>code point</code>ï¼Œå¦‚ <code>A</code> çš„<code>code point</code> æ˜¯ <code>U+0041</code>ï¼›<code>è¿ª</code>çš„ <code>code point</code> æ˜¯ <code>U+8FEA</code>ã€‚</p>
<p><code>Unicode</code> ä¸­çš„å­—ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæ¦‚å¿µå®šä¹‰ã€‚æ¯”å¦‚å­—ç¬¦<code>A</code>ï¼Œå¾ˆæ˜æ˜¾<code>A</code>ä¸åŒäº<code>B</code>ï¼Œä¹Ÿä¸åŒäº<code>a</code>ï¼Œä½†æ˜¯æ— è®ºæ˜¯æ–œä½“çš„<code>A</code>ã€ç²—ä½“çš„<code>A</code>ã€è¿˜æ˜¯æ­£å¸¸çš„<code>A</code>ï¼Œå®ƒä»¬åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯å­—ç¬¦<code>A</code>ã€‚å¯¹äºå­—ä½“<code>Times New Roman</code>ä¸­çš„<code>A</code>ï¼Œåº”è¯¥å’Œå­—ä½“<code>Helvetica</code>ä¸­çš„<code>A</code>ä¸€æ ·ï¼Œéƒ½æ˜¯å­—ç¬¦<code>A</code>ã€‚(å¯¹äºå­—ç¬¦<code>A</code>ï¼Œ<code>Unicode</code>åªå®šä¹‰<code>U+0041</code>æ˜¯å­—ç¬¦<code>A</code>ï¼Œè€Œå…·ä½“çš„è¿™ä¸ªå­—ç¬¦æ˜¾ç¤ºå‡ºæ¥æ—¶ä»€ä¹ˆæ ·å­ï¼Œæ˜¯å®šä¹‰åœ¨å­—ä½“æ–‡ä»¶ä¸­çš„)</p>
<h2 id="ucs-2--utf-16"><code>UCS-2</code> / <code>UTF-16</code></h2>
<p>é‚£ä¹ˆ <code>He</code> ç”¨ <code>Unicode</code> è¡¨ç¤ºå°±æ˜¯ <code>00 48 00 65</code>ã€‚</p>
<p>å¯¹å—ï¼Ÿæ†‹ç€æ€¥ã€‚é‚£å®ƒä¸ºå•¥ä¸èƒ½æ˜¯ <code>48 00 65 00</code> å‘¢ï¼ŸæŠ€æœ¯ä¸Šæ¥è¯´æ²¡æœ‰é—®é¢˜ï¼Œè€Œå®é™…ä¸Šä¹Ÿæ˜¯ä¸¤ç§æ–¹å¼éƒ½å­˜åœ¨ï¼ˆå› ä¸ºç‰¹å®šçš„ <code>CPU</code> ç”¨ç‰¹å®šçš„é¡ºåºä¼šæ›´å¿«ï¼‰â€”â€”å¤§ç«¯åºï¼ˆ<code>big-edian</code>ï¼‰å’Œ å°ç«¯åºï¼ˆ<code>little-endian</code>ï¼‰ã€‚</p>
<p>ä¸ºäº†åŒºåˆ†ï¼Œåœ¨æ–‡æœ¬å¼€å¤´åŠ ä¸Šå­—èŠ‚é¡ºåºæ ‡è®°ä½ï¼Œå¤§ç«¯åºç”¨ <code>FE FF</code>ï¼Œå°ç«¯åºç”¨ <code>FF FE</code>ã€‚</p>
<p>è¿™ç§æ–¹å¼å¯¹äºæ–°ç”Ÿæˆçš„æ–‡æ¡£æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œä½†æ˜¯æ— æ³•å…¼å®¹å·²æœ‰çš„<code>ASCII</code>å’Œ<code>DBCS</code>æ–‡æ¡£ã€‚</p>
<h2 id="utf-8unicode-transformation-format-8-bit">UTF-8ï¼ˆUnicode Transformation Format 8-bitï¼‰</h2>
<p>æ‰€ä»¥ï¼Œå‡ºç°äº†å¦ä¸€ç§å®ç° <code>Unicode</code> å­—ç¬¦é›†çš„ç³»ç»Ÿâ€”â€”<code>UTF-8</code>ã€‚å®ƒé‡‡ç”¨å˜é•¿çš„ç¼–ç ï¼Œç”¨ä¸€ä¸ªå­—èŠ‚å­˜å‚¨ <code>code point 0-127</code>ï¼Œå¯¹ <code>128</code> ä»¥ä¸Šçš„ä½¿ç”¨ <code>2å­—èŠ‚ã€3å­—èŠ‚ï¼Œæœ€å¤šåˆ° 6å­—èŠ‚</code>ã€‚</p>
<p>æ¯”å¦‚ï¼Œè¡¨ç¤ºå­—ç¬¦ <code>â‚¤</code> çš„ <code>Unicode</code> åå…­è¿›åˆ¶å€¼ä¸º <code>U+20A4</code>ï¼Œå…¶äºŒè¿›åˆ¶ä¸º <code>0010 0000 1010 0100</code>ã€‚ç”¨<code>UTF-8</code> æ¥è¡¨ç¤ºå­—ç¬¦<code>â‚¤</code>çš„è¯ï¼Œéœ€è¦<code>3</code>ä¸ªå­—èŠ‚ï¼š</p>
<ul>
<li>ç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰å››ä½ï¼Œç”¨<code>3</code>æ¯”ç‰¹<code>1</code>ï¼ˆä»£è¡¨<code>3</code>ä¸ªå­—èŠ‚ï¼‰åŠ ä¸€ä¸ª<code>0</code>ï¼š<code>1110</code>ã€‚åå››ä½æ¥<code>20A4</code>çš„å‰å››å­èŠ‚ï¼š<code>0010</code>ã€‚å¾—åˆ°<code>1110 0010</code>ã€‚</li>
<li>ç¬¬äºŒå­èŠ‚ä»¥<code>10</code>å¼€å¤´ï¼Œåå…­å­—èŠ‚æ¥<code>20A4</code>çš„å…­å­—èŠ‚ <code>0000 10</code>ï¼Œå¾—åˆ°<code>1000 0010</code>ã€‚</li>
<li>ç¬¬ä¸‰å­èŠ‚è¿˜æ˜¯ä»¥<code>10</code>å¼€å¤´ï¼Œåå…­å­—èŠ‚æ¥<code>20A4</code>æœ€åå…­å­—èŠ‚<code>10 0100</code>ï¼Œå¾—åˆ°<code>1010 0100</code>ã€‚</li>
</ul>
<p>æœ€ç»ˆå¾—åˆ°å­—ç¬¦<code>â‚¤</code>çš„<code>UTF-8</code>è¡¨ç¤ºä¸º<code>1110-0010 1000-0010 1010-0100</code>ã€‚</p>
<blockquote>
<p>å¯¹äºè‹±æ–‡æ–‡æ¡£æ¥è¯´ï¼Œ<code>UTF-8</code> å’Œ <code>ASCII</code>æ˜¯ä¸€æ ·çš„ï¼Œä¸éœ€è¦ä»»ä½•è½¬æ¢ã€‚</p>
</blockquote>
<h3 id="utf-8-æ¯”-utf-16-çœç©ºé—´å—">UTF-8 æ¯” UTF-16 çœç©ºé—´å—ï¼Ÿ</h3>
<p><strong>ä¸ä¸€å®š</strong>ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:center">å­—ç¬¦ä¸²</th>
<th>UTF-8</th>
<th>UTF-16</th>
<th>ç©ºé—´æ¯”è¾ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>AI</code></td>
<td><code>4149</code></td>
<td><code>0041 0049</code></td>
<td><code>UTF-8</code>&lt;<code>UTF-16</code></td>
</tr>
<tr>
<td style="text-align:center"><code>å°„é›•</code></td>
<td><code>E5B0 84E9 9B95</code></td>
<td><code>5C04 96D5</code></td>
<td><code>UTF-8</code>&gt;<code>UTF-16</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>å¦‚æœå­˜å‚¨æ•°æ®è‹±æ–‡å­—ç¬¦è¾ƒå¤šï¼Œ<code>UTF-8</code>è‚¯å®šä¼šæ¯”<code>UTF-16</code>èŠ‚çœç©ºé—´ã€‚</p>
</blockquote>
<h2 id="encodingsç¼–ç ">Encodingsï¼ˆç¼–ç ï¼‰</h2>
<p><img loading="lazy" src="/images/character-encoding.jpeg" alt="encoding"  /></p>
<p><code>Unicode</code>æ˜¯å­—ç¬¦é›†ï¼Œä¸Šé¢è¯´çš„ <code>UCS-2</code>ã€<code>UTF-8</code>ç­‰æ˜¯å®ç°<code>Unicode</code>çš„æ–¹æ³•â€”â€”<code>Encoding</code>ã€‚<code>Encoding</code>æœ‰å¤šç§å®ç°ï¼Œå¦‚<code>UTF-7</code>ã€<code>UTF-32</code>ã€<code>ISO8859-1</code>ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¿…é¡»ç¡®å®šæ‰€ç”¨çš„<code>Encoding</code>æ‰èƒ½æ­£ç¡®å¤„ç†ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p>åœ¨æµè§ˆå™¨ä¸­çœ‹åˆ°è¿™æ¯ä¸ªç½‘é¡µä¼šæœ‰<code>Encoding</code>çš„ä¿¡æ¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&#34;Content-Type&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;text/html; charset=utf-8&#34;</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯æ˜¯ï¼Œåœ¨ä¸çŸ¥é“<code>encoding</code>çš„æƒ…å†µä¸‹æ€ä¹ˆå»è¯»è¿™ä¸ª<code>HTML</code>æ–‡ä»¶æ¥å–åˆ°<code>encoding</code>çš„ä¿¡æ¯å‘¢ï¼Ÿ</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œç»å¤§å¤šæ•°<code>encoding</code>å¯¹ <code>32-127</code> çš„<code>code point</code>çš„å¤„ç†æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥æŠŠæ–‡ä»¶å¼€å¤´çš„å†…å®¹å½“ä½œ<code>ASCII</code>æ¥å¤„ç†ã€‚æ‰€ä»¥<code>encoding</code>ä¿¡æ¯è¶Šæ—©å‡ºç°è¶Šå¥½ï¼Œé¿å…å‡ºç°åœ¨ä»»ä½•<code>code point</code>å¤§äº<code>127</code>çš„å­—ç¬¦ä¹‹åã€‚</p>
<p>å¦å¤–ï¼Œ<code>HTTP</code>è¯·æ±‚å¤´ä¸­ä¹Ÿå¯ä»¥åŒ…å«<code>encoding</code>ä¿¡æ¯ï¼ˆ<code>Content-Type</code>ï¼‰ã€‚</p>
<p>æ—©æœŸçš„æµè§ˆå™¨éƒ½æœ‰è®¾ç½®<code>encoding</code>çš„èœå•ï¼Œä»¥åº”å¯¹æ‰¾ä¸åˆ°<code>encoding</code>å®šä¹‰è€Œæ— æ³•æ­£ç¡®å¤„ç†çš„æƒ…å†µã€‚å¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨ï¼ˆå¦‚<code>Chrome</code>ï¼‰å·²ç»å»æ‰è¯¥èœå•ï¼Œå¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡åˆ¤æ–­å‡ºæ­£ç¡®<code>encoding</code>äº†ã€‚</p>
<h2 id="åŸæ–‡é“¾æ¥">åŸæ–‡é“¾æ¥</h2>
<ul>
<li><a href="https://www.joelonsoftware.com/2003/10/08/the-absolute-minimum-every-software-developer-absolutely-positively-must-know-about-unicode-and-character-sets-no-excuses/">The Absolute Minimum Every Software Developer Absolutely, Positively Must Know About Unicode and Character Sets (No Excuses!)</a></li>
<li><a href="https://mp.weixin.qq.com/s?__biz=Mzg5NDE1MTU2NQ==&amp;mid=2247483816&amp;idx=1&amp;sn=2be8183562976b65cbdc37c711ff79fb&amp;chksm=c022bf4af755365cf1440172cb044f204758796097fb42dfc028ff31c58505b5648e2478f10a&amp;token=258030414&amp;lang=zh_CN#rd">æ¯ä¸ªç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„å­—ç¬¦é›†å‘å±•ç®€å²</a></li>
</ul>
<blockquote>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>è®¾è®¡æ¨¡å¼ï¼šè§‚å¯Ÿè€…æ¨¡å¼ã€è®¢é˜…-å‘å¸ƒæ¨¡å¼ã€äº‹ä»¶ç›‘å¬æ¨¡å¼</title>
      <link>https://blog.tomatostore.top/posts/2023/04/design-pattern-observer/</link>
      <pubDate>Tue, 11 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/design-pattern-observer/</guid>
      <description>Design Pattern: Observer Pattern</description>
      <content:encoded><![CDATA[<p>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆ<code>Observer Pattern</code>ï¼‰è§£å†³çš„å¯¹è±¡é—´çš„ä¸€å¯¹å¤šçš„å…³ç³»ï¼Œå³ä¸€ä¸ªè¢«è§‚å¯Ÿè€…ä¸å¤šä¸ªè§‚å¯Ÿè€…ã€‚æœ€ç›´æ¥çš„ä¾‹å­å°±æ˜¯å…¬ä¼—å·ï¼ˆ<code>Subject</code>ï¼‰åŠè®¢é˜…è€…ï¼ˆ<code>Observer</code>ï¼‰ã€‚</p>
<p>å¯¹äºè§‚å¯Ÿè€…æ¨¡å¼ã€å‘å¸ƒ-è®¢é˜…æ¨¡å¼/äº‹ä»¶ç›‘å¬æ¨¡å¼ï¼Œä¸ºåªæ˜¯ç›¸åŒæŠ€æœ¯å®ç°åŸºç¡€ä¸Šçš„ä¸åŒæ¼”åŒ–ï¼Œå±äºåŒä¸€ç±»è®¾è®¡æ¨¡å¼ã€‚</p>
<hr>
<h2 id="è§‚å¯Ÿè€…æ¨¡å¼10">è§‚å¯Ÿè€…æ¨¡å¼1.0</h2>
<p>æ¶‰åŠä¸¤ä¸ªè§’è‰²ï¼š</p>
<ul>
<li>è¢«è§‚å¯Ÿè€…: Subject/Observable/Publisher, ä¼šæœ‰çŠ¶æ€/æ•°æ®å˜åŒ–çš„å¯¹è±¡ã€‚</li>
<li>è§‚å¯Ÿè€…: Observer/Subscriberï¼Œå…³å¿ƒ<code>è¢«è§‚æµ‹å¯¹è±¡</code>çš„å˜åŒ–ã€‚</li>
</ul>
<p>æœ€åŸºç¡€çš„å®ç°éœ€è¦å®šä¹‰ 2 ä¸ªåŸºç±» <code>Subject</code> å’Œ <code>Observer</code>ã€‚</p>
<blockquote>
<p><code>C++</code>å®ç°</p>
</blockquote>
<h3 id="è§‚å¯Ÿè€…">è§‚å¯Ÿè€…</h3>
<p>å…ˆå®šä¹‰æ¥å£ç±» <code>class Observer</code>ï¼Œè¯¥ç±»æ²¡æœ‰é»˜è®¤å®ç°ï¼Œå­ç±»å¿…é¡»å®ç° <code>update()</code> æ¥å£ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Observer.h 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Observer</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">string</span> <span class="n">msg</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// abstract virtual
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="è¢«è§‚å¯Ÿå¯¹è±¡">è¢«è§‚å¯Ÿå¯¹è±¡</h3>
<p>åŸºç±» <code>Subject</code>ï¼Œå®ƒéœ€è¦çŸ¥é“æœ‰é‚£äº›è§‚å¯Ÿè€…ï¼Œåœ¨éœ€è¦é€šçŸ¥çš„æ—¶å€™éå†è§‚å¯Ÿè€…åˆ—è¡¨å‘é€é€šçŸ¥ã€‚
æœ‰è‡ªå·±çš„å®ç°ï¼Œå®šä¹‰å­ç±»æ—¶ä¸éœ€è¦å¤å†™åŸºç±»çš„æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨å³å¯ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Subject.h
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Subject</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">addObserver</span><span class="p">(</span><span class="n">Observer</span> <span class="o">*</span> <span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">removeObserver</span><span class="p">(</span><span class="n">Observer</span> <span class="o">*</span> <span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">notify</span><span class="p">(</span><span class="n">string</span> <span class="n">msg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">Observer</span><span class="o">*&gt;</span> <span class="n">observers</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Subjet.cpp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Subject</span><span class="o">::</span><span class="n">addObserver</span><span class="p">(</span><span class="n">Observer</span><span class="o">*</span> <span class="n">observer</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">observers</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Subject</span><span class="o">::</span><span class="n">removeObserver</span><span class="p">(</span><span class="n">Observer</span><span class="o">*</span> <span class="n">observer</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">observers</span><span class="p">.</span><span class="n">erase</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Subject</span><span class="o">::</span><span class="n">notify</span><span class="p">(</span><span class="n">string</span> <span class="n">msg</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">obs</span><span class="p">:</span> <span class="n">observers</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">obs</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="åº”ç”¨">åº”ç”¨</h3>
<p>ä»¥å…¬ä¼—å·å’Œè®¢é˜…è€…ä¸ºä¾‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// å…¬ä¼—å·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Publisher</span><span class="o">:</span> <span class="k">public</span> <span class="n">Subject</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">addArticle</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span> <span class="n">article</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">articles</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">article</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">notify</span><span class="p">(</span><span class="n">article</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">vector</span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span> <span class="n">articles</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è®¢é˜…è€…
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Subscriber</span><span class="o">:</span> <span class="k">public</span> <span class="n">Observer</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span><span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">)</span><span class="o">:</span> <span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">string</span> <span class="n">article</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">readArticle</span><span class="p">(</span><span class="n">article</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">readArticle</span><span class="p">(</span><span class="n">string</span> <span class="n">article</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; is reading article : &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">article</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Publisher</span> <span class="n">publisher</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span> <span class="n">sub1</span><span class="p">(</span><span class="s">&#34;Tom&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addObserver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addArticle</span><span class="p">(</span><span class="s">&#34;Article 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span> <span class="n">sub2</span><span class="p">(</span><span class="s">&#34;Jerry&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addObserver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addArticle</span><span class="p">(</span><span class="s">&#34;Article 2&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰§è¡Œç»“æœï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">Tom</span> <span class="n">is</span> <span class="n">reading</span> <span class="nl">article</span> <span class="p">:</span> <span class="n">Article</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Tom</span> <span class="n">is</span> <span class="n">reading</span> <span class="nl">article</span> <span class="p">:</span> <span class="n">Article</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="n">Jerry</span> <span class="n">is</span> <span class="n">reading</span> <span class="nl">article</span> <span class="p">:</span> <span class="n">Article</span> <span class="mi">2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="è§‚å¯Ÿè€…æ¨¡å¼20">è§‚å¯Ÿè€…æ¨¡å¼2.0</h2>
<p>ä¸Šé¢çš„<code>Observer</code>æä¾›äº†ä¸€ä¸ªå¸¦æœ‰ä¸€ä¸ªå‚æ•°çš„<code>update</code>æ¥å£ï¼š <code>virtual void update(string msg)</code>ã€‚
è™½ç„¶åœ¨åº”ç”¨ä¸­å¯ä»¥é€šè¿‡ä¼ é€’ä¸åŒå‚æ•°æ¥åŒºåˆ†ä¸åŒçš„é€šçŸ¥ï¼Œæ¯”å¦‚ï¼š<code>update(&quot;å…¨éƒ¨è®¢é˜…è€…å¯è§æ›´æ–°&quot;)</code>ï¼Œ<code>update(&quot;VIPè®¢é˜…è€…å¯è§æ›´æ–°&quot;)</code>ï¼Œä½†å¯¹äºå¤æ‚ä¸€ç‚¹çš„éœ€è¦å¤šå‚æ•°ä¼ é€’çš„åœºæ™¯å°±ä¸é€‚ç”¨äº†ã€‚</p>
<p>é‚£ä¹ˆå¯ä»¥é€šè¿‡å¼•å…¥<code>Event</code>ç±»å‹ï¼Œä»¥æ›´çµæ´»çš„å®šä¹‰ä¸åŒçš„ã€å¤æ‚çš„é€šçŸ¥ç±»å‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Event æ¥å£å®šä¹‰
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">enum</span> <span class="nc">EventType</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ARTICLE_UPDATED</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">VIP_ARTICLE_UPDATED</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Event</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="n">EventType</span> <span class="n">type</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="o">~</span><span class="n">Event</span><span class="p">()</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// å…·ä½“çš„ Event ç±»å‹
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">ArticleUpdatedEvent</span><span class="o">:</span> <span class="k">public</span> <span class="n">Event</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="n">EventType</span> <span class="n">type</span><span class="p">()</span> <span class="k">override</span> <span class="p">{</span> <span class="k">return</span> <span class="n">ARTICLE_UPDATED</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="nf">getArticle</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">article</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">setArticle</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span> <span class="n">article</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">article</span> <span class="o">=</span> <span class="n">article</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">article</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">VipArticleUpdatedEvent</span><span class="o">:</span> <span class="k">public</span> <span class="n">Event</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">virtual</span> <span class="n">EventType</span> <span class="n">type</span><span class="p">()</span> <span class="k">override</span> <span class="p">{</span> <span class="k">return</span> <span class="n">VIP_ARTICLE_UPDATED</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="nf">getArticle</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">article</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">setArticle</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span> <span class="n">article</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">article</span> <span class="o">=</span> <span class="n">article</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="nf">getReward</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span> <span class="k">return</span> <span class="n">reward</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">setReward</span><span class="p">(</span><span class="kt">int</span> <span class="n">reward</span><span class="p">)</span> <span class="p">{</span> <span class="k">this</span><span class="o">-&gt;</span><span class="n">reward</span> <span class="o">=</span> <span class="n">reward</span><span class="p">;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">article</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kt">int</span> <span class="n">reward</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å°†<code>Observer</code>æ›´æ–°ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Observer.h 
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Observer</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// virtual void update(string msg) = 0; // abstract virtual
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">update</span><span class="p">(</span><span class="n">shared_pointer</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">event</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// abstract virtual
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>Subject</code>æ›´æ–°ä¸ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Subject.h
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Subject</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// virtual void notify(string msg);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">notify</span><span class="p">(</span><span class="n">shared_pointer</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">event</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">...</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p>åº”ç”¨åˆ°<code>å…¬ä¼—å·â€”â€”è®¢é˜…è€…</code>ä¸Šï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// å…¬ä¼—å·
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Publisher</span><span class="o">:</span> <span class="k">public</span> <span class="n">Subject</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="n">addArticle</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span> <span class="n">article</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">e</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">ArticleUpdatedEvent</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">e</span><span class="o">-&gt;</span><span class="n">setArticle</span><span class="p">(</span><span class="n">article</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">notify</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">addVipArticleWithReward</span><span class="p">(</span><span class="k">const</span> <span class="n">string</span><span class="o">&amp;</span> <span class="n">article</span><span class="p">,</span> <span class="kt">int</span> <span class="n">reward</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">auto</span> <span class="n">e</span> <span class="o">=</span> <span class="n">make_shared</span><span class="o">&lt;</span><span class="n">VipArticleUpdatedEvent</span><span class="o">&gt;</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">e</span><span class="o">-&gt;</span><span class="n">setArticle</span><span class="p">(</span><span class="n">article</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">e</span><span class="o">-&gt;</span><span class="n">setReward</span><span class="p">(</span><span class="n">reward</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">notify</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// è®¢é˜…è€…
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">class</span> <span class="nc">Subscriber</span><span class="o">:</span> <span class="k">public</span> <span class="n">Observer</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span><span class="p">(</span><span class="n">string</span> <span class="n">name</span><span class="p">)</span><span class="o">:</span> <span class="n">name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">   <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">update</span><span class="p">(</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">event</span><span class="p">)</span> <span class="k">override</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">EventType</span><span class="o">::</span><span class="nl">ARTICLE_UPDATED</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">auto</span> <span class="n">e</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">ArticleUpdatedEvent</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">get</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">!=</span> <span class="k">nullptr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">string</span> <span class="n">article</span> <span class="o">=</span> <span class="n">e</span><span class="o">-&gt;</span><span class="n">getArticle</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">readArticle</span><span class="p">(</span><span class="n">article</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">case</span> <span class="n">EventType</span><span class="o">::</span><span class="nl">VIP_ARTICLE_UPDATED</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">auto</span> <span class="n">e</span> <span class="o">=</span> <span class="k">dynamic_cast</span><span class="o">&lt;</span><span class="n">VipArticleUpdatedEvent</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">get</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="p">(</span><span class="n">e</span> <span class="o">!=</span> <span class="k">nullptr</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">string</span> <span class="n">vipArticle</span> <span class="o">=</span> <span class="n">e</span><span class="o">-&gt;</span><span class="n">getArticle</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">readArticle</span><span class="p">(</span><span class="n">vipArticle</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                    <span class="kt">int</span> <span class="n">reward</span> <span class="o">=</span> <span class="n">e</span><span class="o">-&gt;</span><span class="n">getReward</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">                    <span class="n">earnReward</span><span class="p">(</span><span class="n">reward</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">            <span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">readArticle</span><span class="p">(</span><span class="n">string</span> <span class="n">article</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; is reading article : &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">article</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kt">void</span> <span class="nf">earnReward</span><span class="p">(</span><span class="kt">int</span> <span class="n">reward</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">name</span> <span class="o">&lt;&lt;</span> <span class="s">&#34; earned reward : &#34;</span> <span class="o">&lt;&lt;</span> <span class="n">reward</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">string</span> <span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Publisher</span> <span class="n">publisher</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span> <span class="n">sub1</span><span class="p">(</span><span class="s">&#34;Tom&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addObserver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addArticle</span><span class="p">(</span><span class="s">&#34;Article 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span> <span class="n">sub2</span><span class="p">(</span><span class="s">&#34;Jerry&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addObserver</span><span class="p">(</span><span class="o">&amp;</span><span class="n">sub2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addVipArticleWithReward</span><span class="p">(</span><span class="s">&#34;Article 2&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰§è¡Œç»“æœï¼š</p>
<pre tabindex="0"><code>Tom is reading article : Article 1

Tom is reading article : Article 2
Tom earned reward : 5
Jerry is reading article : Article 2
Jerry earned reward : 5
</code></pre><p>é€šè¿‡ç»§æ‰¿<code>Event</code>ï¼Œè¿™ä¸ªç‰ˆæœ¬æ”¯æŒçµæ´»çš„æ‰©å±•é€šçŸ¥ç±»å‹ï¼Œå¯¹ä¼ é€’çš„å‚æ•°ä¸ªæ•°å’Œç±»å‹æ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚</p>
<p>ç›®å‰ä¸ºæ­¢ï¼Œè¢«è®¢é˜…å¯¹è±¡å‘é€ <code>notify</code> æ—¶å¯¹æ‰€æœ‰çš„è®¢é˜…è€…éƒ½æ˜¯ä¸€è§†åŒä»çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªè®¢é˜…è€…æ¥æ”¶åˆ°çš„æ¶ˆæ¯æ˜¯ä¸€æ ·çš„ã€‚</p>
<p>å¯¹äºä¸Šé¢å…¬ä¼—å·çš„ä¾‹å­ï¼Œå¦‚æœæƒ³å®ç°å¯¹ VIP è®¢é˜…è€…å’Œæ™®é€šè®¢é˜…è€…æ¨é€ä¸åŒçš„é€šçŸ¥ï¼Œé‚£å°±å¯ä»¥é€šè¿‡å¦‚ä¸‹çš„æ–¹å¼ã€‚</p>
<hr>
<h2 id="è§‚å¯Ÿè€…æ¨¡å¼30">è§‚å¯Ÿè€…æ¨¡å¼3.0</h2>
<p>æ›´æ”¹ <code>Subject</code> çš„è®¢é˜…å’Œé€šçŸ¥æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Subject.h
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Subject</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="n">addObserver</span><span class="p">(</span><span class="n">EventType</span> <span class="n">type</span><span class="p">,</span> <span class="n">Observer</span> <span class="o">*</span> <span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">removeObserver</span><span class="p">(</span><span class="n">EventType</span> <span class="n">type</span><span class="p">,</span> <span class="n">Observer</span> <span class="o">*</span> <span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">notify</span><span class="p">(</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">event</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">private</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">std</span><span class="o">::</span><span class="n">map</span><span class="o">&lt;</span><span class="n">EventType</span><span class="p">,</span> <span class="n">std</span><span class="o">::</span><span class="n">set</span><span class="o">&lt;</span><span class="n">Observer</span><span class="o">*&gt;</span> <span class="o">&gt;</span> <span class="n">observers</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Subjet.cpp
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Subject</span><span class="o">::</span><span class="n">addObserver</span><span class="p">(</span><span class="n">EventType</span> <span class="n">type</span><span class="p">,</span> <span class="n">Observer</span><span class="o">*</span> <span class="n">observer</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">observers</span><span class="p">[</span><span class="n">type</span><span class="p">].</span><span class="n">insert</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Subject</span><span class="o">::</span><span class="n">removeObserver</span><span class="p">(</span><span class="n">EventType</span> <span class="n">type</span><span class="p">,</span> <span class="n">Observer</span><span class="o">*</span> <span class="n">observer</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">observers</span><span class="p">[</span><span class="n">type</span><span class="p">].</span><span class="n">erase</span><span class="p">(</span><span class="n">observer</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="n">Subject</span><span class="o">::</span><span class="n">notify</span><span class="p">(</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">Event</span><span class="o">&gt;</span> <span class="n">event</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">obs</span><span class="p">:</span> <span class="n">observers</span><span class="p">[</span><span class="n">event</span><span class="o">-&gt;</span><span class="n">type</span><span class="p">()])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">obs</span><span class="o">-&gt;</span><span class="n">update</span><span class="p">(</span><span class="n">event</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¿®æ”¹<code>main</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Publisher</span> <span class="n">publisher</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span> <span class="n">sub1</span><span class="p">(</span><span class="s">&#34;Tom&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addObserver</span><span class="p">(</span><span class="n">EventType</span><span class="o">::</span><span class="n">ARTICLE_UPDATED</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sub1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addArticle</span><span class="p">(</span><span class="s">&#34;Article 1&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Subscriber</span> <span class="n">sub2</span><span class="p">(</span><span class="s">&#34;Jerry&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addObserver</span><span class="p">(</span><span class="n">EventType</span><span class="o">::</span><span class="n">VIP_ARTICLE_UPDATED</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">sub2</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">publisher</span><span class="p">.</span><span class="n">addVipArticleWithReward</span><span class="p">(</span><span class="s">&#34;VIP Article 2&#34;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ‰§è¡Œç»“æœï¼š</p>
<pre tabindex="0"><code>Tom is reading article : Article 1

Jerry is reading article : VIP Article 2
Jerry earned reward : 5
</code></pre><p>æ­¤ç‰ˆæœ¬è¿›åŒ–åˆ°äº†ä¸€ä¸ªæ›´ä¸ºç‰¹æ®Šçš„è§‚å¯Ÿè€…æ¨¡å¼â€”â€”â€”å‘å¸ƒè®¢é˜…è€…æ¨¡å¼ï¼Œæˆ–è€…å«äº‹ä»¶è®¢é˜…æ¨¡å¼ã€‚</p>
<h3 id="observer-pattern-vs-publish-subscribe-pattern">Observer Pattern v.s. Publish-Subscribe Pattern</h3>
<p>å…¶ä¸»è¦åŒºåˆ«æ˜¯è§‚å¯Ÿè€…æ¨¡å¼æ¶‰åŠä¸¤ç§è§’è‰² <code>Subject</code> å’Œ <code>Observer</code>ï¼Œè€Œå‘å¸ƒè®¢é˜…æ¨¡å¼ä¸­é—´å¤šäº†ä¸€ä¸ª<code>Event</code>å¤„ç†ï¼Œæœ‰çš„ç§°ä¹‹ä¸º<code>Broker</code>æˆ–<code>Channel</code>:</p>
<p><img loading="lazy" src="/images/observer-pattern-v.s.-publish-subscript-pattern.jpeg" alt="Observer Pattern v.s. Publish-Subscribe Pattern"  /></p>
<hr>
<h2 id="å®Œæ•´ä»£ç ">å®Œæ•´ä»£ç </h2>
<ul>
<li><a href="https://github.com/AidySun/aidysun.github.io/tree/main/src/design-pattern-observer.v1.0.cpp">design-pattern-observer v1.0.cpp</a></li>
<li><a href="https://github.com/AidySun/aidysun.github.io/tree/main/src/design-pattern-observer.v2.0.cpp">design-pattern-observer v2.0.cpp</a></li>
<li><a href="https://github.com/AidySun/aidysun.github.io/tree/main/src/design-pattern-observer.v3.0.cpp">design-pattern-observer v3.0.cpp</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Swift: beginAnimations(_:context:) was deprecated in iOS 13.0: Use the block-based animation API instead</title>
      <link>https://blog.tomatostore.top/posts/2023/04/swift-block-based-animation/</link>
      <pubDate>Sun, 02 Apr 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/04/swift-block-based-animation/</guid>
      <description>Swift / Objective-C block-based animation</description>
      <content:encoded><![CDATA[<p>ç”¨ <code>Xcode 14.2</code> å‡çº§ä¸€ä¸ª <code>Swift</code> é¡¹ç›®æ—¶æœ‰ç¼–è¯‘è­¦å‘Šï¸âš æç¤º <code>beginAnimations()</code> åœ¨ <code>iOS 13.0</code> åå·²ç»ä¸æ¨èä½¿ç”¨ï¼Œåº”è¯¥ç”¨ <code>block-based animation</code> ä»£æ›¿ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="hl"><span class="lnt">1
</span></span><span class="hl"><span class="lnt">2
</span></span><span class="hl"><span class="lnt">3
</span></span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line hl"><span class="cl"><span class="n">UIView</span><span class="p">.</span><span class="n">beginAnimations</span><span class="p">(</span><span class="kc">nil</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span> <span class="c1">// &#39;beginAnimations(_:context:)&#39; was deprecated in iOS 13.0: Use the block-based animation API instead</span>
</span></span><span class="line hl"><span class="cl"><span class="n">UIView</span><span class="p">.</span><span class="n">setAnimationDuration</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="c1">// &#39;setAnimationDuration&#39; was deprecated in iOS 13.0: Use the block-based animation API instead</span>
</span></span><span class="line hl"><span class="cl"><span class="n">UIView</span><span class="p">.</span><span class="n">commitAnimations</span><span class="p">()</span> <span class="c1">// &#39;commitAnimations()&#39; was deprecated in iOS 13.0: Use the block-based animation API instead </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">currentOverlay</span> <span class="p">=</span> <span class="n">overlay</span>
</span></span><span class="line"><span class="cl"><span class="n">currentOverlayTarget</span> <span class="p">=</span> <span class="n">overlayTarget</span>
</span></span><span class="line"><span class="cl"><span class="n">currentLoadingText</span> <span class="p">=</span> <span class="n">loadingText</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p>ä¿®æ”¹ä¸ºä½¿ç”¨ <code>Block-based animation</code> çš„ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-swift" data-lang="swift"><span class="line"><span class="cl"><span class="n">UIView</span><span class="p">.</span><span class="n">animate</span><span class="p">(</span><span class="n">withDuration</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">currentOverlay</span> <span class="p">=</span> <span class="n">overlay</span>
</span></span><span class="line"><span class="cl">    <span class="n">currentOverlayTarget</span> <span class="p">=</span> <span class="n">overlayTarget</span>
</span></span><span class="line"><span class="cl">    <span class="n">currentLoadingText</span> <span class="p">=</span> <span class="n">loadingText</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æœç”¨ <code>Objective-C</code> åˆ™ä¿®æ”¹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-objc" data-lang="objc"><span class="line"><span class="cl"><span class="p">[</span><span class="n">UIView</span> <span class="nl">animateWithDuration</span><span class="p">:</span> <span class="mf">0.5</span>
</span></span><span class="line"><span class="cl">                 <span class="nl">animations</span><span class="p">:</span> <span class="o">^</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">currentOverlay</span> <span class="o">=</span> <span class="n">overlay</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">currentOverlayTarget</span> <span class="o">=</span> <span class="n">overlayTarget</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">currentLoadingText</span> <span class="o">=</span> <span class="n">loadingText</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}];</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></content:encoded>
    </item>
    
    <item>
      <title>èƒ½å¦åœ¨ C&#43;&#43; çš„æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ this æŒ‡é’ˆ</title>
      <link>https://blog.tomatostore.top/posts/2023/03/this-pointer-in-cpp-ctor/</link>
      <pubDate>Mon, 27 Mar 2023 22:07:21 +0800</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/03/this-pointer-in-cpp-ctor/</guid>
      <description>æ„é€ å‡½æ•°æ²¡æ‰§è¡Œå®Œï¼Œthisä¸å¯ä»¥ç”¨ï¼Ÿç»§æ‰¿å¤šæ€ä¸­çˆ¶ç±»èƒ½å¦ç”¨thisæŒ‡é’ˆè§¦å‘å¤šæ€è°ƒç”¨ï¼Ÿ</description>
      <content:encoded><![CDATA[<p>ç›´æ¥è¯´ç»“è®ºï¼š<strong>å¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨ thisï¼Œä½†æ˜¯ï¼Œå¤šæ€æ— æ³•ç”Ÿæ•ˆã€‚</strong></p>
<p>æœ‰äººè®¤ä¸ºåœ¨æ„é€ å‡½æ•°ä¸­ï¼Œå¯¹è±¡çš„æ„é€ è¿˜æ²¡æœ‰å®Œæˆï¼Œä¸èƒ½ä½¿ç”¨ this æŒ‡é’ˆã€‚
æ ¹æ®<a href="https://isocpp.org/wiki/faq/ctors#using-this-in-ctors">Should you use the this pointer in the constructor?</a>çš„æè¿°ï¼Œåœ¨æ„é€ å‡½æ•°çš„å‡½æ•°ä½“ä¸­ä½¿ç”¨thisæŒ‡é’ˆå¯ä»¥æ”¾å¿ƒçš„è®¿é—®çˆ¶ç±»å’Œè‡ªå·±ç±»ä¸­å®šä¹‰çš„æ•°æ®æˆå‘˜ï¼ˆdata membersï¼‰ã€‚å› ä¸ºé‚£äº›æ•°æ®æˆå‘˜åœ¨æ„é€ å‡½æ•°å¼€å§‹æ‰§è¡Œæ—¶å·²ç»æ„é€ å®Œæˆäº†ã€‚</p>
<blockquote>
<p>Here is something that always works: the {body} of a constructor (or a function called from the constructor) can reliably access the data members declared in a base class and/or the data members declared in the constructorâ€™s own class. This is because all those data members are guaranteed to have been fully constructed by the time the constructorâ€™s {body} starts executing.</p>
</blockquote>
<p>ä½†è¦<strong>æ³¨æ„</strong>åœ¨æœ‰ç»§æ‰¿çš„æƒ…å†µä¸‹ï¼Œå³ä½¿æ˜¯æ­£åœ¨æ„é€ ä¸€ä¸ªå­ç±»å®ä¾‹ï¼Œåœ¨çˆ¶ç±»çš„æ„é€ é˜¶æ®µï¼Œå½“å‰çš„å®ä¾‹è¿˜ä¸æ˜¯å­ç±»å‹ã€‚</p>
<blockquote>
<p>The bottom line is this: even if the caller is constructing an object of a derived class, during the constructor of the base class, your object is not yet of that derived class. You have been warned.</p>
</blockquote>
<p>è¿™ä¹Ÿå°±å¯¼è‡´äº†åœ¨çˆ¶ç±»çš„æ„é€ å‡½æ•°ä¸­ï¼ŒthisæŒ‡é’ˆæ˜¯æ— æ³•è§¦å‘å¤šæ€ï¼Œä¹Ÿå°±æ˜¯æ— æ³•è°ƒç”¨åˆ°æ­£ç¡®çš„è™šå‡½æ•°ï¼ˆvirtual functionsï¼‰ã€‚</p>
<blockquote>
<p>Here is something that never works: the {body} of a constructor (or a function called from the constructor) cannot get down to a derived class by calling a virtual member function that is overridden in the derived class. If your goal was to get to the overridden function in the derived class, you wonâ€™t get what you want. Note that you wonâ€™t get to the override in the derived class independent of how you call the virtual member function: explicitly using the this pointer (e.g., this-&gt;method()), implicitly using the this pointer (e.g., method()), or even calling some other function that calls the virtual member function on your this object.</p>
</blockquote>
<p>å¯ä»¥ç”¨å¦‚ä¸‹çš„ä¾‹å­ç±»éªŒè¯ä¸€ä¸‹ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="hl"><span class="lnt">10
</span></span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="hl"><span class="lnt">25
</span></span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="hl"><span class="lnt">57
</span></span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">A</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;A() { </span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line hl"><span class="cl">    <span class="k">this</span><span class="o">-&gt;</span><span class="n">vf</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">-&gt;</span><span class="n">f1</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;} </span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">A</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;~A()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">vf</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;  A&#39;s vf()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">f1</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;  A&#39;s f1()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line hl"><span class="cl">    <span class="n">vf</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">B</span> <span class="o">:</span> <span class="k">public</span> <span class="n">A</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">public</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">  <span class="n">B</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;B() { </span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">-&gt;</span><span class="n">vf</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="o">-&gt;</span><span class="n">f1</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;} </span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="o">~</span><span class="n">B</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;~B()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">vf</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;  B&#39;s vf()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kt">void</span> <span class="nf">f1</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;  B&#39;s f1()</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">vf</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;creat A a</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">A</span> <span class="n">a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;creat B b</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line hl"><span class="cl">  <span class="n">B</span> <span class="n">b</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&#34;======</span><span class="se">\n</span><span class="s">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span></span></span></code></pre></td></tr></table>
</div>
</div>
<p>æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="hl"><span class="lnt"> 9
</span></span><span class="lnt">10
</span><span class="hl"><span class="lnt">11
</span></span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">creat A a
</span></span><span class="line"><span class="cl">A<span class="o">()</span> <span class="o">{</span> 
</span></span><span class="line"><span class="cl">  A<span class="s1">&#39;s vf()
</span></span></span><span class="line"><span class="cl"><span class="s1">  A&#39;</span>s f1<span class="o">()</span>
</span></span><span class="line"><span class="cl">  A<span class="s1">&#39;s vf()
</span></span></span><span class="line"><span class="cl"><span class="s1">} 
</span></span></span><span class="line"><span class="cl"><span class="s1">creat B b  // å¼€å§‹æ„é€  B b;
</span></span></span><span class="line"><span class="cl"><span class="s1">A() { 
</span></span></span><span class="line hl"><span class="cl"><span class="s1">  A&#39;</span>s vf<span class="o">()</span> // åœ¨Bçš„æ„é€ è¿‡ç¨‹ä¸­ï¼Œçˆ¶ç±»Aä¸­çš„thisè°ƒç”¨çš„æ˜¯Açš„virtual <span class="k">function</span> 
</span></span><span class="line"><span class="cl">  A<span class="s1">&#39;s f1()
</span></span></span><span class="line hl"><span class="cl"><span class="s1">  A&#39;</span>s vf<span class="o">()</span> // åŒæ ·ï¼Œåœ¨çˆ¶ç±»æ„é€ å‡½æ•°ä¸­é—´æ¥è°ƒç”¨çš„è™šå‡½æ•°ï¼Œä¹Ÿä¸ä¼šè°ƒç”¨å­ç±»çš„è™šå‡½æ•°
</span></span><span class="line"><span class="cl"><span class="o">}</span> 
</span></span><span class="line"><span class="cl">B<span class="o">()</span> <span class="o">{</span> 
</span></span><span class="line"><span class="cl">  B<span class="s1">&#39;s vf()
</span></span></span><span class="line"><span class="cl"><span class="s1">  B&#39;</span>s f1<span class="o">()</span>
</span></span><span class="line"><span class="cl">  B<span class="err">&#39;</span>s vf<span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> 
</span></span><span class="line"><span class="cl"><span class="o">======</span>
</span></span><span class="line"><span class="cl">~B<span class="o">()</span>
</span></span><span class="line"><span class="cl">~A<span class="o">()</span>
</span></span><span class="line"><span class="cl">~A<span class="o">()</span></span></span></code></pre></td></tr></table>
</div>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>å¦‚ä½•åˆ é™¤æœ¬åœ° git ä¸­æœªè¿½è¸ªçš„æ–‡ä»¶/æ–‡ä»¶å¤¹</title>
      <link>https://blog.tomatostore.top/posts/2023/03/git-rm-untracked-file-dir/</link>
      <pubDate>Fri, 24 Mar 2023 00:00:00 +0000</pubDate>
      
      <guid>https://blog.tomatostore.top/posts/2023/03/git-rm-untracked-file-dir/</guid>
      <description>git clean/delete untracked files, folders</description>
      <content:encoded><![CDATA[<p>å¯¹äºä¸€ä¸ª git é¡¹ç›®ï¼Œæ‰§è¡Œ <code>git status -u</code> æœ‰å¦‚ä¸‹çŠ¶æ€ï¼š</p>
<p><img loading="lazy" src="/images/git-status--u.png" alt="git status -u result"  title="hi"  /></p>
<p>å¯¹äºæœ¬åœ°æ–°å¢çš„æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ <code>clean</code> å‘½ä»¤ç›´æ¥åˆ é™¤ï¼š</p>
<p><img loading="lazy" src="/images/git-clean--f.png" alt="git clean -f"  /></p>
<p><img loading="lazy" src="/images/git-status--u-2.png" alt="after clean"  /></p>
<p>ä½†æ˜¯æœ¬åœ°æ–°å¢çš„æ–‡ä»¶å¤¹å´æ²¡æœ‰è¢«åˆ é™¤æ‰ã€‚è¦åˆ é™¤æ–‡ä»¶å¤¹éœ€è¦åŠ ä¸Š <code>-d</code> å‚æ•°ï¼š</p>
<p><img loading="lazy" src="/images/git-clean-fd.png" alt="git clean -f -d"  /></p>
<p>è¿˜æœ‰ä¸€ç§æƒ…å†µå°±æ˜¯å·²ç»åœ¨ <code>.gitignore</code> ä¸­çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹æ˜¯ä¸ä¼šè¢«åˆ é™¤çš„ã€‚</p>
<p><img loading="lazy" src="/images/cat-.gitignore.png" alt="cat .gitignore"  /></p>
<p><img loading="lazy" src="/images/git-status---ignored.png" alt="git status &amp;ndash;ignored"  /></p>
<p>éœ€è¦é€šè¿‡ <code>-x</code> é€‰é¡¹æ¥åˆ é™¤è¢« <code>.gitignore</code> åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹ï¼š</p>
<p><img loading="lazy" src="/images/git-clean--fdx.png" alt="git clean -f -d -x"  /></p>
<h2 id="git-clean-options"><code>git clean</code> options</h2>
<table>
<thead>
<tr>
<th style="text-align:center">Option</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><code>-f</code></td>
<td><em>Delete files or diretories</em></td>
</tr>
<tr>
<td style="text-align:center"><code>-d</code></td>
<td><em>Recurse into untracked directories</em></td>
</tr>
<tr>
<td style="text-align:center"><code>-x</code></td>
<td><em>Donâ€™t use the standard ignore rules</em></td>
</tr>
</tbody>
</table>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
